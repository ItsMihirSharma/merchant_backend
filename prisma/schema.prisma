// This is your Prisma schema file for SQLite (testing)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model Order {
  id                String      @id @default(cuid())
  orderId           String      @unique
  customerName      String
  customerEmail     String
  customerPhone     String?
  shippingAddress   String      // JSON as string for SQLite
  items             String      // JSON as string for SQLite
  totalAmount       Float
  status            String      @default("PENDING")
  paymentMethod     String?
  transactionHash   String?     @unique
  blockNumber       Int?
  confirmations     Int         @default(0)
  chain             String?
  token             String?
  merchantAddress   String?
  customerAddress   String?
  metadata          String?     // JSON as string for SQLite
  createdAt         DateTime    @default(now())
  updatedAt         DateTime    @updatedAt
  confirmedAt       DateTime?
  fulfilledAt       DateTime?
}

model WebhookLog {
  id        String   @id @default(cuid())
  orderId   String
  eventType String
  payload   String   // JSON as string for SQLite
  signature String
  verified  Boolean
  processed Boolean  @default(false)
  error     String?
  createdAt DateTime @default(now())
}

model Configuration {
  id                    String   @id @default(cuid())
  merchantWallet        String
  webhookUrl            String?
  supportedChains       String   // JSON array as string for SQLite
  supportedTokens       String   // JSON array as string for SQLite
  testnetMode           Boolean  @default(false)
  requiredConfirmations Int      @default(12)
  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}

model Admin {
  id           String   @id @default(cuid())
  email        String   @unique
  passwordHash String
  name         String
  role         String   @default("admin")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}
